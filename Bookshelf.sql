
CREATE TABLE Types (
    id      integer,
    type    text,
    primary key (id)
);

CREATE TABLE Authors (
    id      integer,
    first_name  text,
    last_name   text,
    primary key (id)
);

CREATE TABLE Tags (
    id      integer,
    tag     text,
    primary key (id)
);

CREATE TABLE Books (
    id      integer,
    title   text,
    author  integer,
    type    integer,
    primary key (id),
    foreign key (author) references Authors(id) ON DELETE CASCADE ON UPDATE CASCADE,
    foreign key (type) references Types(id) ON DELETE CASCADE ON UPDATE CASCADE
);

CREATE TABLE Books_Tags (
    book    integer,
    tag     integer,
    foreign key (book) references Books(id) ON DELETE CASCADE ON UPDATE CASCADE,
    foreign key (tag) references Tags(id) ON DELETE CASCADE ON UPDATE CASCADE
);

insert into Types values (1, 'Non-Fiction');
insert into Types values (2, 'Fiction');
insert into Types values (3, 'Textbook');
insert into Types values (4, 'Magazine');
insert into Types values (5, 'Poetry');

insert into Tags values (1,'Philosophy');
insert into Tags values (2,'Science');
insert into Tags values (3,'Mathematics');
insert into Tags values (4,'Eastern');
insert into Tags values (5,'Poetry');
insert into Tags values (6,'Self Help');
insert into Tags values (7,'History');
insert into Tags values (8, 'Stoicism');
insert into Tags values (9, 'Taoism');
insert into Tags values (10, 'Buddhism');
insert into Tags values (11, 'Data');
insert into Tags values (12, 'Technology');
insert into Tags values (13, 'Play');
insert into Tags values (14, 'Classic');
insert into Tags values (15, 'Science Fiction');
insert into Tags values (16, 'Short Stories');
insert into Tags values (17, 'Satire');
insert into Tags values (18, 'Comedy');
insert into Tags values (19, 'Australian');
insert into Tags values (20, 'Dystopian');
insert into Tags values (21, 'Environmental');
insert into Tags values (22, 'Political');
insert into Tags values (23, 'Economics');
insert into Tags values (24, 'Meditation / Mindfulness');
insert into Tags values (25, 'Art');
insert into Tags values (26, 'Statistics');
insert into Tags values (27, 'Biographical');

insert into Authors values (1,'Ryan','Holiday');
insert into Authors values (2,'Lao','Tzu');
insert into Authors values (3,'David','Whyte');
insert into Authors values (4,'Nobuo','Suzuki');
insert into Authors values (5, 'Chuang','Tzu');
insert into Authors values (6, 'Sam', 'Harris');
insert into Authors values (7, 'Kamo No', 'Chomei');
insert into Authors values (8, 'Yoshida', 'Kenko');
insert into Authors values (9,'William', 'Irvine');
insert into Authors values (10, 'Thich Nhat', 'Hanh');
insert into Authors values (11, 'Saigyo');
insert into Authors values (12, 'Rumi', 'Al Jaladin');
insert into Authors values (13, 'Sam', 'Hamill');
insert into Authors values (14, 'Jer', 'Thorp');
insert into Authors values (15, 'Robert Elliot', 'Smith');
insert into Authors values (16, 'Micheal','Kearns');
insert into Authors values (17, 'Peter S', 'Fosl');
insert into Authors values (18, 'Jaron', 'Lanier');
insert into Authors values (19, 'Nate', 'Silver');
insert into Authors values (20, 'Michael','Wooldridge');
insert into Authors values (21, 'Chirstopher', 'Marlowe');
insert into Authors values (22, 'Henry David', 'Thoreau');
insert into Authors values (23, 'William', 'Burroughs');
insert into Authors values (24, 'Hunter S', 'Thompson');
insert into Authors values (25, 'George', 'Orwell');
insert into Authors values (26, 'Charles W', 'Kennedy');
insert into Authors values (27, 'Joseph', 'Conrad');
insert into Authors values (28, 'Franz', 'Kafka');
insert into Authors values (29, 'Ernest', 'Hemingway');
insert into Authors values (30, 'Arthur C', 'Clarke');
insert into Authors values (31, 'Edgar Allan', 'Poe');
insert into Authors values (32, 'Steven', 'Pressfield');
insert into Authors values (33, 'William', 'Golding');
insert into Authors values (34, 'Yevgeny', 'Zamyatin');
insert into Authors values (35, 'H.G','Wells');
insert into Authors values (36, 'Albert','Camus');
insert into Authors values (37, 'Douglas', 'Adams');
insert into Authors values (38, 'John D', 'Kelleher');
insert into Authors values (39, 'Stephen M', 'Stigler');
insert into Authors values (40, 'Albert', 'Einstein');
insert into Authors values (41, 'Dante', 'Alighieri');
insert into Authors values (42, 'Aldous', 'Huxley');
insert into Authors values (43, 'Thorstein', 'Veblen');
insert into Authors values (44, 'Olly', 'Richards');
insert into Authors values (45, 'Voltaire');
insert into Authors values (46, 'Leonard', 'Mlodinow');
insert into Authors values (47, 'Steven', 'Strogatz');
insert into Authors values (48, 'George', 'Polya');
insert into Authors values (49, 'Max', 'Tegmark');
insert into Authors values (50, 'Simone', 'de Beauvoir');
insert into Authors values (51, 'Friedrich', 'Nietzsche');
insert into Authors values (52, 'A.C', 'Grayling');
insert into Authors values (53, 'Neil', 'de Grasse Tyson');
insert into Authors values (54, 'Stephen', 'Hawking');
insert into Authors values (55, 'Brian','Cox');
insert into Authors values (56, 'Michio', 'Kaku');
insert into Authors values (57, 'Luke', 'Heaton');
insert into Authors values (58, 'Alex', 'Bellos');
insert into Authors values (59, 'Isaac', 'Newton');
insert into Authors values (60, 'Euclid');
insert into Authors values (61, 'Massimo', 'Pigliucci');
insert into Authors values (62, 'Yuval Noah', 'Harari');
insert into Authors values (63, 'Tom','Butler-Bowdon');
insert into Authors values (64, 'Thomas S', 'Kuhn');
insert into Authors values (65, 'Carlo', 'Rovelli');
insert into Authors values (66, 'Epicurus');
insert into Authors values (67, 'Musonius','Rufus');
insert into Authors values (68, 'Dalai','Lama');
insert into Authors values (69, 'Karen', 'Armstrong');
insert into Authors values (70, 'Paul', 'Johnson');
insert into Authors values (71, 'Seneca');
insert into Authors values (72, 'Epictetus');
insert into Authors values (73, 'Marcus','Aurelius');
insert into Authors values (74, 'Alain','de Botton');
insert into Authors values (75, 'Niccolo','Machiavelli');
insert into Authors values (76, 'Plato');
insert into Authors values (77, 'Robert M','Pirsig');
insert into Authors values (78, 'Shunryu','Suzuki');
insert into Authors values (79, 'Antonia', 'Macaro');
insert into Authors values (80, 'Erling', 'Kagge');
insert into Authors values (81, 'David', 'Hinton');
insert into Authors values (82, 'Rob', 'Nairn');
insert into Authors values (83, 'Fritjof', 'Capra');
insert into Authors values (84, 'Ramana','Maharshi');
insert into Authors values (85, 'Simon','Blackburn');
insert into Authors values (86, 'Karl', 'Marx');
insert into Authors values (87, 'Paul', 'Mason');
insert into Authors values (88, 'Royal Insitute of Australia');
insert into Authors values (89, 'Galileo','Galilei');
insert into Authors values (90, 'Stephen Jay','Gould');
insert into Authors values (91, 'John', 'Steinbeck');
insert into Authors values (92, 'Fernando', 'Corbalan');
insert into Authors values (93, 'D','Hilbert');
insert into Authors values (94, 'Damien', 'Kingsbury');
insert into Authors values (95, 'Robert', 'Kaplan');
insert into Authors values (96, 'Philip J', 'Davis');
insert into Authors values (97, 'Peter','Fitzsimons');
insert into Authors values (98, 'Ian W', 'Shaw');
insert into Authors values (99, 'Peter','Carey');
insert into Authors values (100, 'William','Gibson');
insert into Authors values (101, 'Thomas', 'Piketty');
insert into Authors values (102, NULL ,'James');
insert into Authors values (103, NULL,'Kreyzig');
insert into Authors values (104, NULL, 'Boyce');
insert into Authors values (105, NULL, 'Shenk');
insert into Authors values (106, NULL, 'Spivak');
insert into Authors values (107, NULL, 'Jones');
insert into Authors values (108, 'A.J','Roberts');
insert into Authors values (109, NULL,'Capinski');
insert into Authors values (110, NULL, 'Vretblad');
insert into Authors values (111, NULL, 'Winston');
insert into Authors values (112, NULL, 'Gerstein');
insert into Authors values (113, NULL, 'Abbott');
insert into Authors values (114, NULL, 'Axler');
insert into Authors values (115, NULL, 'De Veaux');
insert into Authors values (116, 'Marco','Taboga');
insert into Authors values (117, NULL, 'Wackerly');
insert into Authors values (118, 'George','Casella');
insert into Authors values (119, 'Annette J', 'Dobson');
insert into Authors values (120, 'Jared P','Lander');
insert into Authors values (121, 'Peter', 'Grossman');
insert into Authors values (122, 'Peter J', 'Cameron');
insert into Authors values (123, 'Hadley', 'Wickham');
insert into Authors values (124, 'Ramez', 'Elmasri');
insert into Authors values (125, 'Chris', 'Turville');
insert into Authors values (126, 'Christopher', 'Clapham');
insert into Authors values (127, 'Gary','Iseminger');
insert into Authors values (128, NULL, 'Kolmogorov');
insert into Authors values (129, 'Bert', 'Mendelson');
insert into Authors values (130, 'George E', 'Andrews');
insert into Authors values (131, 'Hans', 'Lauwerier');
insert into Authors values (132, 'Donald W','Hight');
insert into Authors values (133, 'Paul G','Hewitt');
insert into Authors values (134, 'Martha J','Groom');
insert into Authors values (135, 'John','Chaffee');
insert into Authors values (136, 'Joan', 'Casteel');
insert into Authors values (137, 'G. Tyler', 'Miller');


insert into Books values (1, 'The Obstacle is the Way',1,1);
insert into Books_Tags values (1,1);
insert into Books_Tags values (1,8);
insert into Books_Tags values (1,6);
insert into Books values (2, 'Ego is the Enemy',1,1);
insert into Books_Tags values (2,1);
insert into Books_Tags values (2,8);
insert into Books_Tags values (2,6);
insert into Books values (3, 'Stillness is the Key',1,1);
insert into Books_Tags values (3,1);
insert into Books_Tags values (3,8);
insert into Books_Tags values (3,6);
insert into Books values (4, 'Tao Te Ching',2,1);
insert into Books_Tags values (4, 1);
insert into Books_Tags values (4, 9);
insert into Books_Tags values (4, 4);
insert into Books values (5, 'Consolations',3,5);
insert into Books_Tags values (5, 5);
insert into Books values (6, 'Wabi Sabi',4,1);
insert into Books_Tags values (6, 4);
insert into Books_Tags values (6, 25);
insert into Books values (7, 'The Tao of Nature',5,1);
insert into Books_Tags values (7, 1);
insert into Books_Tags values (7, 9);
insert into Books_Tags values (7, 4);
insert into Books values (8, 'Waking Up', 6, 1);
insert into Books_Tags values (8, 2);
insert into Books_Tags values (8, 24);
insert into Books values (9, 'Hojoki',7,1);
insert into Books_Tags values (9, 10);
insert into Books_Tags values (9, 4);
insert into Books values (10, 'Essays in Idleness',8,1);
insert into Books_Tags values(10, 1);
insert into Books_Tags values (10, 4);
insert into Books values (11, 'A Guide to the Good Life',9,1);
insert into Books_Tags values (11,1);
insert into Books_Tags values (11,8);
insert into Books_Tags values (11,6);
insert into Books values (12, 'The Heart of the Buddha''s Teaching', 10, 1);
insert into Books_Tags values (12, 4);
insert into Books_Tags values (12, 10);
insert into Books_Tags values (12, 1);
insert into Books values (13, 'Present Moment, Wonderful Moment', 10, 1);
insert into Books_Tags values (13, 24);
insert into Books_Tags values (13, 10);
insert into Books values (14, 'Gazing at the Moon', 11, 5);
insert into Books_Tags values (14, 10);
insert into Books_Tags values (14, 5);
insert into Books values (15, 'Poems', 12, 5);
insert into Books_Tags values (15, 4);
insert into Books_Tags values (15, 5);
insert into Books values (16, 'The Pocket Haiku', 13, 5);
insert into Books_Tags values (16, 4);
insert into Books_Tags values (16, 5);
insert into Books values (17, 'Living in Data', 14, 1);
insert into Books_Tags values (17, 11);
insert into Books_Tags values (17, 12);
insert into Books values (18, 'Rage Inside the Machine', 15, 1);
insert into Books_Tags values (18, 11);
insert into Books_Tags values (18, 12);
insert into Books values (19, 'The Ethical Algorithm', 16, 1);
insert into Books_Tags values (19, 11);
insert into Books_Tags values (19, 12);
insert into Books values (20, 'The Critical Thinking Toolkit', 17, 1);
insert into Books_Tags values (20, 1);
insert into Books values (21, 'The Ethics Toolkit', 17, 1);
insert into Books_Tags values (21, 1);
insert into Books values (22, 'You Are Not a Gadget', 18, 1);
insert into Books_Tags values (22, 11);
insert into Books_Tags values (22, 12);
insert into Books values (23, 'The Signal and the Noise', 19, 1);
insert into Books_Tags values (23, 11);
insert into Books_Tags values (23, 26);
insert into Books values (24, 'The Road to Conscious Machines', 20, 1);
insert into Books_Tags values (24, 11);
insert into Books_Tags values (24, 12);
insert into Books values (25, 'Doctor Faustus',21,2);
insert into Books_Tags values(25, 13);
insert into Books_Tags values(25, 14);
insert into Books values (26, 'Walden', 22, 1);
insert into Books_Tags values (26, 1);
insert into Books_Tags values (26, 14);
insert into Books values (27, 'Naked Lunch', 23, 2);
insert into Books_Tags values(27, 17);
insert into Books values (28, 'The Rum Diary', 24, 2);
insert into Books values (29, '1984', 25, 2);
insert into Books_Tags values (29, 20);
insert into Books_Tags values (29, 14);
insert into Books values (30, 'Beowulf', 26, 5);
insert into Books_Tags values (30, 14);
insert into Books values (31, 'Heart of Darkness', 27, 2);
insert into Books_Tags values (31, 14);
insert into Books values (32, 'Metamorphosis, and other stories', 28, 2);
insert into Books_Tags values (32, 1);
insert into Books_Tags values (32, 16);
insert into Books values (33, 'Fear and Loathing in Las Vegas', 24, 2);
insert into Books_Tags values (33, 22);
insert into Books values (34, 'The Old Man and The Sea', 29, 2);
insert into Books_Tags values (34, 14);
insert into Books values (35, 'Animal Farm', 25, 2);
insert into Books_Tags values (35, 14);
insert into Books_Tags values (35, 22);
insert into Books values (36, 'Earthlight', 30, 2);
insert into Books_Tags values (36, 15);
insert into Books values (37, 'Tales of Mystery and Imagination', 31, 2);
insert into Books_Tags values (37, 14);
insert into Books_Tags values (37, 16);
insert into Books values (38, 'Gates of Fire', 32, 2);
insert into Books_Tags values (38, 7);
insert into Books values (39, 'Lord of the Flies', 33, 2);
insert into Books_Tags values (39, 14);
insert into Books values (40, 'We', 34, 2);
insert into Books_Tags values (40, 20);
insert into Books values (41, 'War of the Worlds', 35, 2);
insert into Books_Tags values (41, 14);
insert into Books_Tags values (41, 15);
insert into Books values (42, 'The Stranger', 36, 2);
insert into Books_Tags values (42, 1);
insert into Books values (43, 'The Hitchhiker''s Guide to the Galaxy', 37, 2);
insert into Books_Tags values (43, 18);
insert into Books_Tags values (43, 15);
insert into Books values (44, 'The Restaurant at the End of the Universe', 37, 2);
insert into Books_Tags values (44, 18);
insert into Books_Tags values (44, 15);
insert into Books values (45, 'Life, the Universe, and Everything', 37, 2);
insert into Books_Tags values (45, 18);
insert into Books_Tags values (45, 15);
insert into Books values (46, 'So Long, and Thanks For All The Fish', 37, 2);
insert into Books_Tags values (46, 18);
insert into Books_Tags values (46, 15);
insert into Books values (47, 'Mostly Harmless', 37, 2);
insert into Books_Tags values (47, 18);
insert into Books_Tags values (47, 15);
insert into Books values (48, 'Data Science', 38, 1);
insert into Books_Tags values (48, 11);
insert into Books_Tags values (48, 12);
insert into Books values (50, 'The Seven Pillars of Statistical Wisdom', 39, 1);
insert into Books_Tags values (50, 26);
insert into Books values (51, 'On Cosmic Religion, and Other Opinions and Aphorisms', 40, 1);
insert into Books_Tags values (51, 2);
insert into Books values (52, 'Inferno', 41, 5);
insert into Books_Tags values (52, 14);
insert into Books values (53, 'Brave New World', 42, 2);
insert into Books_Tags values (53, 14);
insert into Books_Tags values (53, 20);
insert into Books values (54, 'Conspicuous Consumption', 43, 1);
insert into Books_Tags values (54, 17);
insert into Books values (55, 'Short Stories in German', 44, 2);
insert into Books_Tags values (55, 16);
insert into Books values (56, 'Candide', 45, 2);
insert into Books_Tags values (56, 14);
insert into Books_Tags values (56, 17);
insert into Books values (57, 'The Drunkard''s Walk', 46, 1);
insert into Books_Tags values (57, 26);
insert into Books values (58, 'Infinite Powers', 47, 1);
insert into Books_Tags values (58, 3);
insert into Books values (59, 'How To Solve It', 48, 1);
insert into Books_Tags values (59, 3);
insert into Books values (60, 'Our Mathematical Universe', 49, 1);
insert into Books_Tags values (60, 3);
insert into Books values (61, 'The Ethics of Ambiguity', 50, 1);
insert into Books_Tags values (61, 1);
insert into Books values (62, 'Thus Spoke Zarathustra', 51, 2);
insert into Books_Tags values (62, 1);
insert into Books values (63, 'The History of Philosophy', 52, 1);
insert into Books_Tags values (63, 1);
insert into Books_Tags values (63, 7);
insert into Books values (64, 'Astrophysics for People In A Hurry', 53, 1);
insert into Books_Tags values (64, 2);
insert into Books values (65, 'The Grand Design', 54, 1);
insert into Books_Tags values (65, 2);
insert into Books values (66, 'A Brief History of Time', 54, 1);
insert into Books_Tags values (66, 2);
insert into Books values (67, 'Human Universe', 55, 1);
insert into Books_Tags values (67, 2);
insert into Books values (68, 'Parallel Worlds', 56, 1);
insert into Books_Tags values (68, 2);
insert into Books values (69, 'A Brief History of Mathematical Thought', 57, 1);
insert into Books_Tags values (69, 3);
insert into Books_Tags values (69, 7);
insert into Books values (70, 'The Grapes of Math', 58, 1);
insert into Books_Tags values (70, 3);
insert into Books values (71, 'Philosophiae Naturalis Principia Mathematica', 59,1);
insert into Books_Tags values (71, 3);
insert into Books_Tags values (71, 2);
insert into Books values (72, 'Elements', 60, 1);
insert into Books_Tags values (72, 3);
insert into Books values (73, 'Relativity', 40, 1);
insert into Books_Tags values (73, 2);
insert into Books values (74, 'How To Be A Stoic', 61, 1);
insert into Books_Tags values (74,1);
insert into Books_Tags values (74,8);
insert into Books_Tags values (74,6);
insert into Books values (75, '21 Lessons for the 21st Century', 62, 1);
insert into Books_Tags values (75, 23);
insert into Books_Tags values (75, 7);
insert into Books values (76, '50 Philosophy Classics', 63, 1);
insert into Books_Tags values (76, 1);
insert into Books values (77, 'The Structure of Scientific Revolutions', 64, 1);
insert into Books_Tags values (77, 2);
insert into Books_Tags values (77, 1);
insert into Books values (78, 'The Daily Stioc', 1,1);
insert into Books_Tags values (78,1);
insert into Books_Tags values (78,8);
insert into Books_Tags values (78,6);
insert into Books values (79, 'The Order of Time', 65, 1);
insert into Books_Tags values (79, 2);
insert into Books values (80, 'The Art of Happiness', 66, 1);
insert into Books_Tags values (80, 1);
insert into Books values (81, 'That One Should Disdain Hardships', 67, 1);
insert into Books_Tags values (81,1);
insert into Books_Tags values (81,8);
insert into Books values (82, 'The Heart of the Buddha''s Path', 68, 1);
insert into Books_Tags values (82, 1);
insert into Books_Tags values (82, 10);
insert into Books values (83, 'Buddha', 69, 1);
insert into Books_Tags values (83, 10);
insert into Books_Tags values (83, 7);
insert into Books_Tags values (83, 27);
insert into Books values (84, 'Socrates', 70, 1);
insert into Books_Tags values (84, 1);
insert into Books_Tags values (84, 7);
insert into Books_Tags values (84, 27);
insert into Books values (85, 'Letters From A Stoic', 71, 1);
insert into Books_Tags values (85,1);
insert into Books_Tags values (85,8);
insert into Books values (86, 'How To Be Free', 72, 1);
insert into Books_Tags values (86,1);
insert into Books_Tags values (86,8);
insert into Books values (87, 'Meditations', 73, 1);
insert into Books_Tags values (87,1);
insert into Books_Tags values (87,8);
insert into Books values (88, 'The Consolations of Philosophy', 74, 1);
insert into Books_Tags values (88, 1);
insert into Books values (89, 'The Prince', 75, 1);
insert into Books_Tags values (89, 1);
insert into Books values (90, 'The Great Dialogues of Plato', 76, 1);
insert into Books_Tags values (90, 1);
insert into Books values (91, 'Zen and the Art of Motorcycle Maintenance', 77, 1);
insert into Books_Tags values (91, 1);
insert into Books_Tags values (91, 27);
insert into Books values (92, 'Zen Mind, Beginner''s Mind', 78, 1);
insert into Books_Tags values (92, 1);
insert into Books_Tags values (92, 4);
insert into Books_Tags values (92, 10);
insert into Books values (93, 'More Than Happiness', 79, 1);
insert into Books_Tags values (93,1);
insert into Books_Tags values (93,8);
insert into Books_Tags values (93,6);
insert into Books_Tags values (93, 10);
insert into Books values (94, 'Silence', 80, 1);
insert into Books_Tags values (94, 1);
insert into Books values (95, 'China Root', 81, 1);
insert into Books_Tags values (95, 4);
insert into Books_Tags values (95, 9);
insert into Books_Tags values (95, 10);
insert into Books_Tags values (95, 7);
insert into Books values (96, 'From Mindfulness to Insight', 82, 1);
insert into Books_Tags values (96, 10);
insert into Books_Tags values (95, 24);
insert into Books values (97, 'The Tao of Physics', 83, 1);
insert into Books_Tags values (97, 4);
insert into Books_Tags values (97, 2);
insert into Books values (98, 'The Spiritual Teachings', 84, 1);
insert into Books_Tags values (98, 4);
insert into Books values (99, 'Republic', 76, 1);
insert into Books_Tags values (99, 1);
insert into Books values (100, 'Think', 85, 1);
insert into Books_Tags values (100, 1);
insert into Books values (101, 'The Communist Manifesto', 86, 1);
insert into Books_Tags values (101, 23);
insert into Books_Tags values (101, 22);
insert into Books values (102, 'The Doors of Perception', 42, 1);
insert into Books_Tags values (102, 2);
insert into Books_Tags values (102, 25);
insert into Books values (103, 'Postcapitalism', 87, 1);
insert into Books_Tags values (103, 23);
insert into Books_Tags values (103, 22);
insert into Books values (104, 'Cosmos: Issue 76', 88, 4);
insert into Books_Tags values (104, 2);
insert into Books values (105, 'Cosmos: Issue 77', 88, 4);
insert into Books_Tags values (105, 2);
insert into Books values (106, 'Cosmos: Issue 78', 88, 4);
insert into Books_Tags values (106, 2);
insert into Books values (107, 'Cosmos: Issue 79', 88, 4);
insert into Books_Tags values (107, 2);
insert into Books values (108, 'Cosmos: Issue 80', 88, 4);
insert into Books_Tags values (108, 2);
insert into Books values (109, 'Cosmos: Issue 81', 88, 4);
insert into Books_Tags values (109, 2);
insert into Books values (110, 'Cosmos: Issue 82', 88, 4);
insert into Books_Tags values (110, 2);
insert into Books values (111, 'Cosmos: Issue 83', 88, 4);
insert into Books_Tags values (111, 2);
insert into Books values (112, 'Cosmos: Issue 84', 88, 4);
insert into Books_Tags values (112, 2);
insert into Books values (113, 'Cosmos: Issue 85', 88, 4);
insert into Books_Tags values (113, 2);
insert into Books values (114, 'Cosmos: Issue 86', 88, 4);
insert into Books_Tags values (114, 2);
insert into Books values (115, 'Cosmos: Issue 87', 88, 4);
insert into Books_Tags values (115, 2);
insert into Books values (116, 'Cosmos: Issue 88', 88, 4);
insert into Books_Tags values (116, 2);
insert into Books values (117, 'Cosmos: Issue 89', 88, 4);
insert into Books_Tags values (117, 2);
insert into Books values (118, 'Cosmos: Issue 90', 88, 4);
insert into Books_Tags values (118, 2);
insert into Books values (119, 'Cosmos: Issue 91', 88, 4);
insert into Books_Tags values (119, 2);
insert into Books values (120, 'Cosmos: Issue 92', 88, 4);
insert into Books_Tags values (120, 2);
insert into Books values (121, 'Cosmos: Issue 93', 88, 4);
insert into Books_Tags values (121, 2);
insert into Books values (122, 'Dialogue Concerning The Two Chief World Systems', 89, 1);
insert into Books_Tags values (122, 2);
insert into Books values (123, 'Dinosaur In A Haystack', 90, 1);
insert into Books_Tags values (123, 2);
insert into Books values (124, 'The Long, Dark Tea Time of the Soul', 37, 2);
insert into Books_Tags values (124, 18);
insert into Books values (125, 'The Deeper Meaning of Liff', 37, 2);
insert into Books_Tags values (125, 18);
insert into Books values (126, 'Of Mice and Men', 91, 2);
insert into Books_Tags values (126, 14);
insert into Books values (127, 'The Golden Ratio', 92, 1);
insert into Books_Tags values (127, 3);
insert into Books values (128, 'Mathematical Logic', 93, 3);
insert into Books_Tags values (128, 3);
insert into Books values (129, 'Politics in Developing Countries', 94, 3);
insert into Books_Tags values (129,22);
insert into Books_Tags values (129, 23);
insert into Books values (130, 'The Oxford Dictionary of Phiolosophy', 85, 3);
insert into Books_Tags values (130, 1);
insert into Books values (131, 'The Art of the Infinite', 95, 1);
insert into Books_Tags values (131, 3);
insert into Books values (132, 'The Mathematical Experience', 96, 1);
insert into Books_Tags values (132, 3);
insert into Books values (133, 'Ned Kelly', 97, 1);
insert into Books_Tags values (133, 19);
insert into Books_Tags values (133, 27);
insert into Books_Tags values (133, 7);
insert into Books values (134, 'Glenrowan', 98, 1);
insert into Books_Tags values (134, 19);
insert into Books_Tags values (134, 27);
insert into Books_Tags values (134, 7);
insert into Books values (135, 'The True History of the Kelly Gang', 99, 1);
insert into Books_Tags values (135, 19);
insert into Books_Tags values (135, 27);
insert into Books_Tags values (135, 7);
insert into Books values (136, 'Mona Lisa Overdrive', 100, 2);
insert into Books_Tags values (136, 20);
insert into Books_Tags values (136, 15);
insert into Books values (137, 'Count Zero', 100, 2);
insert into Books_Tags values (137, 20);
insert into Books_Tags values (137, 15);
insert into Books values (138, 'Neuromancer', 100, 2);
insert into Books_Tags values (138, 20);
insert into Books_Tags values (138, 15);
insert into Books values (139, 'Capital', 101, 1);
insert into Books_Tags values (139,22);
insert into Books_Tags values (139, 23);
insert into Books values (140, 'Modern Engineering Mathematics', 102, 3);
insert into Books_Tags values (140, 3);
insert into Books values (141, 'Advanced Engineering Mathematics', 103, 3);
insert into Books_Tags values (141, 3);
insert into Books values (142, 'Elementary Differential Equations', 104, 3);
insert into Books_Tags values (142, 3);
insert into Books values (143, 'Calculus and Analytic Geometry', 105, 3);
insert into Books_Tags values (143, 3);
insert into Books values (144, 'Calculus', 106, 3);
insert into Books_Tags values (144, 3);
insert into Books values (145, 'Elementary Concepts of Mathematics', 107, 3);
insert into Books_Tags values (145, 3);
insert into Books values (146, 'Continuum Mechanics', 108, 3);
insert into Books_Tags values (146, 3);
insert into Books values (147, 'Measure, Integral, and Probability',109, 3);
insert into Books_Tags values (147, 3);
insert into Books values (148, 'Fourier Analysis and its Applications', 110, 3);
insert into Books_Tags values (148, 3);
insert into Books values (149, 'Operations Research', 111, 3);
insert into Books_Tags values (149, 3);
insert into Books values (150, 'Introduction to Mathematical Structures and Proofs', 112, 3);
insert into Books_Tags values (150, 3);
insert into Books values (151, 'Understanding Analysis', 113, 3);
insert into Books_Tags values (151, 3);
insert into Books values (152, 'Linear Algebra Done Right', 114, 3);
insert into Books_Tags values (152, 3);
insert into Books values (153, 'Stats, Data and Models', 115, 3);
insert into Books_Tags values (153, 26);
insert into Books_Tags values (153, 11);
insert into Books values (154, 'Lectures on Probability Theory and Mathematical Statistics', 116, 3);
insert into Books_Tags values (154, 3);
insert into Books_Tags values (154, 26);
insert into Books values (155, 'Mathematical Statistics with Applications', 117, 3);
insert into Books_Tags values (155, 3);
insert into Books_Tags values (155, 26);
insert into Books values (156, 'Statistical Inference', 118, 3);
insert into Books_Tags values (156, 3);
insert into Books_Tags values (156, 26);
insert into Books_Tags values (156, 11);
insert into Books values (157, 'An Introduction to Generalized Linear Models', 119,3);
insert into Books_Tags values (157, 11);
insert into Books_Tags values (157, 26);
insert into Books values (158, 'R for Everyone', 120, 3);
insert into Books_Tags values (158, 11);
insert into Books_Tags values (158, 26);
insert into Books_Tags values (158, 12);
insert into Books values (159, 'Discrete Mathematics for Computing', 121, 3);
insert into Books_Tags values (159, 3);
insert into Books_Tags values (159, 12);
insert into Books values (160, 'Combinatorics', 122, 3);
insert into Books_Tags values (160, 3);
insert into Books values (161, 'R for Data Science', 123, 3);
insert into Books_Tags values (161, 11);
insert into Books_Tags values (161, 12);
insert into Books values (162, 'Fundamentals of Database Systems', 124, 3);
insert into Books_Tags values (162, 26);
insert into Books_Tags values (162, 12);
insert into Books_Tags values (162, 11);
insert into Books values (163, 'Introductory Physics', 125, 3);
insert into Books_Tags values (163, 2);
insert into Books_Tags values (163, 3);
insert into Books values (164, 'Oxford Concise Dictionary of Mathematics', 126, 3);
insert into Books_Tags values (164, 3);
insert into Books values (165, 'Logic and Philosophy', 127, 3);
insert into Books_Tags values (165, 1);
insert into Books_Tags values (165, 3);
insert into Books values (166, 'Introductory Real Analysis', 128, 3);
insert into Books_Tags values (166, 3);
insert into Books values (167, 'Introduction to Topology', 129, 3); 
insert into Books_Tags values (167, 3);
insert into Books values (168, 'Number Theory', 130, 3);
insert into Books_Tags values (168, 3);
insert into Books values (169, 'Fractals', 131, 3);
insert into Books_Tags values (169, 3);
insert into Books values (170, 'A Concept of Limits', 132, 3);
insert into Books_Tags values (170, 3);
insert into Books values (171, 'Conceptual Integrated Science', 133, 3);
insert into Books_Tags values (171, 2);
insert into Books values (172, 'Principles of Conservation Biology', 134, 3);
insert into Books_Tags values (172, 21);
insert into Books_Tags values (172, 2);
insert into Books values (173, 'Thinking Critically', 135, 3);
insert into Books_Tags values (173, 2);
insert into Books values (174, 'Oracle 12c: SQL', 136, 3);
insert into Books_Tags values (174, 11);
insert into Books_Tags values (174, 12);
insert into Books values (175, 'Living in the Environment', 137, 3);
insert into Books_Tags values(175, 21);

CREATE VIEW author_fullname AS
    SELECT id, COALESCE(first_name || ' ','') || COALESCE(last_name,'') as full_name
    FROM authors;

CREATE VIEW books_author_type AS
    SELECT b.id, b.title, a.full_name as author, t.type
    FROM books b JOIN author_fullname a ON b.author = a.id
	JOIN types t ON b.type = t.id;

CREATE VIEW type_count AS
	SELECT type, count(*)
	FROM books_author_type
	GROUP BY type
	ORDER BY count DESC;

CREATE VIEW tag_counts AS
	SELECT t.tag, count(*)
	FROM books_tags b JOIN tags t on b.tag = t.id
	GROUP BY t.tag
	ORDER BY count DESC;

CREATE VIEW spreadsheet_view AS
    SELECT y.id, y.title, y.author, y.type, x.tags
    FROM books_author_type y JOIN (
        select book, STRING_AGG(tag, ', ') tags
        from (select b.book, t.tag from books_tags b JOIN tags t ON b.tag = t.id) as l
        group by l.book) as x ON y.id = x.book;